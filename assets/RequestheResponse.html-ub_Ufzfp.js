import{_ as a,o as t,c as e,a as p,f as o}from"./app-GYMnAgnr.js";const c="/viteblog/assets/468-zt9PhdF5.png",n="/viteblog/assets/469-vLBP6dZM.png",l="/viteblog/assets/470-AufL4QQt.png",i="/viteblog/assets/471-bHYGafgE.png",u="/viteblog/assets/472-gZNfEEkq.png",r="/viteblog/assets/473-ky_u1iqG.png",k="/viteblog/assets/474-P0punswp.png",d="/viteblog/assets/475-de0D-0ZJ.png",v="/viteblog/assets/476-pMo1Vsb3.png",m="/viteblog/assets/477-S0GJ6Afa.png",g="/viteblog/assets/478-N3lbVBT1.png",b="/viteblog/assets/479-WsFdvzHK.png",q="/viteblog/assets/480-snTfRsaC.png",S="/viteblog/assets/494-ltZGrr4R.png",h="/viteblog/assets/481-7t5yfnD_.png",w="/viteblog/assets/482-uCtAjlYs.png",y="/viteblog/assets/483-KJhYMSPx.png",R="/viteblog/assets/484-D01qBIzq.png",s="data:image/png;base64,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",f="/viteblog/assets/022-iTj1b__w.png",x="/viteblog/assets/23-KTxs2LMq.png",j="/viteblog/assets/24-FVkcSC9C.png",E="/viteblog/assets/025-sNruhWHS.png",T="/viteblog/assets/223--D44ax8K.png",H="/viteblog/assets/486-icCsNz04.png",P="/viteblog/assets/487-udDv7ilH.png",O={},A=o('<h2 id="request-和-response-的概述" tabindex="-1"><a class="header-anchor" href="#request-和-response-的概述" aria-hidden="true">#</a> Request 和 Response 的概述</h2><p>Request 是请求对象，Response 是响应对象。</p><p>这两个对象在我们使用 Servlet 的时候看到过：</p><p><img src="'+c+'" alt="1628735216156"></p><p>那么，request 和 response 这两个参数的作用是什么呢？</p><p><img src="'+n+`" alt=""></p><ul><li><p>request：<strong>获取请求数据</strong></p><ol><li><p>浏览器会发送 HTTP 请求到后台服务器 [Tomcat]</p></li><li><p>HTTP 的请求中会包含很多请求数据 [请求行+请求头+请求体]</p></li><li><p>后台服务器 [Tomcat] 会对 HTTP 请求中的数据进行解析并把解析结果存入到一个对象中</p></li><li><p>所存入的对象即为 request 对象，所以我们可以从 request 对象中获取请求的相关参数</p></li><li><p>获取到数据后就可以继续后续的业务，比如获取用户名和密码就可以实现登录操作的相关业务</p></li></ol></li><li><p>response：<strong>设置响应数据</strong></p><ol><li><p>业务处理完后，后台就需要给前端返回业务处理的结果即响应数据</p></li><li><p>把响应数据封装到 response 对象中</p></li><li><p>后台服务器 [Tomcat] 会解析 response 对象，按照 [响应行+响应头+响应体] 格式拼接结果</p></li><li><p>浏览器最终解析结果，把内容展示在浏览器给用户浏览</p></li></ol></li></ul><p>对于上述所讲的内容，下面通过一个案例来初步体验下 request 和 response 对象的使用。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/demo3&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletDemo3</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//使用request对象 获取请求数据</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//url?name=zhangsan</span>

        <span class="token comment">//使用response对象 设置响应数据</span>
        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;content-type&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;text/html;charset=utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;h1&gt;&quot;</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">&quot;,欢迎您！&lt;/h1&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Post...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动成功后就可以通过浏览器来访问，并且根据传入参数的不同就可以在页面上展示不同的内容:</p><img src="`+l+'" alt="1628738273049" style="zoom:67%;"><p><strong>总结</strong>：</p><ul><li>request 对象是用来 <strong>封装请求数据</strong> 的对象</li><li>response 对象是用来 <strong>封装响应数据</strong> 的对象</li></ul><h2 id="request-对象" tabindex="-1"><a class="header-anchor" href="#request-对象" aria-hidden="true">#</a> Request 对象</h2><h3 id="request-继承体系" tabindex="-1"><a class="header-anchor" href="#request-继承体系" aria-hidden="true">#</a> Request 继承体系</h3><p>先思考一个问题，前面在介绍 Request 和 Reponse 对象的时候，比较细心的同学可能已经发现：</p><ul><li>当我们的 Servlet 类实现的是 Servlet 接口的时候，service() 方法中的参数是 ServletRequest 和 ServletResponse</li><li>当我们的 Servlet 类继承的是 HttpServlet 类的时候，doGet() 和 doPost() 方法中的参数就变成 HttpServletRequest 和 HttpServletReponse</li></ul><p>那么，请问：</p><ul><li>ServletRequest 和 HttpServletRequest 的关系是什么？</li><li>request 对象是有谁来创建的？</li><li>request 提供了哪些 API，这些 API 从哪里查？</li></ul><p>首先，我们先来看下Request的继承体系:</p><img src="'+i+'" alt="1628740441008" style="zoom:67%;"><p>从上图中可以看出，ServletRequest 和 HttpServletRequest 都是 Java 提供的，所以我们可以查看 JavaEE 提供的 API 文档：</p><p><img src="'+u+'" alt="1628741839475"></p><p>所以 ServletRequest 和 HttpServletRequest 是继承关系，并且两个都是接口，接口是无法创建对象的，这就引发了下面的问题：</p><p><img src="'+r+`" alt="1628742224589"></p><p>这个时候，我们就需要用到 Request 继承体系中的 <strong>RequestFacade</strong>：</p><ul><li>该类实现了 HttpServletRequest 接口，也间接实现了 ServletRequest 接口。</li><li>Servlet 类中的 service 方法、doGet() 方法或者是 doPost() 方法最终都是由 Web 服务器 [Tomcat] 来调用的，所以 Tomcat 提供了方法参数接口的具体实现类，并完成了对象的创建</li><li>要想了解 RequestFacade 中都提供了哪些方法，我们可以直接查看 JavaEE 的 API 文档中关于 ServletRequest 和 HttpServletRequest 的接口文档，因为 RequestFacade 实现了其接口就需要重写接口中的方法</li></ul><p>对于上述结论，要想验证，可以编写一个 Servlet，在方法中把 request 对象打印下，就能看到最终的对象是不是 RequestFacade，代码如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/demo2&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletDemo2</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动服务器，运行访问 <code>http://localhost:8080/request-demo/demo2</code>，得到运行结果：</p><p><img src="`+k+'" alt="1628743040046"></p><p><strong>总结</strong>：</p><ul><li>Request 的继承体系为 ServletRequest--&gt;HttpServletRequest--&gt;RequestFacade</li><li>Tomcat 需要解析请求数据，封装为 request 对象，并且创建 request 对象传递到 service 方法</li><li>使用 request 对象，可以查阅 JavaEE API 文档的 HttpServletRequest 接口中方法说明</li></ul><h3 id="request-获取请求数据" tabindex="-1"><a class="header-anchor" href="#request-获取请求数据" aria-hidden="true">#</a> Request 获取请求数据</h3><p>HTTP 请求数据总共分为三部分内容，分别是 <strong>请求行、请求头、请求体</strong>。</p><h4 id="获取请求行数据" tabindex="-1"><a class="header-anchor" href="#获取请求行数据" aria-hidden="true">#</a> 获取请求行数据</h4><p>请求行包含三块内容，分别是 <strong>请求方式、请求资源路径、HTTP 协议及版本</strong></p><p><img src="'+d+`" alt="1628748240075"></p><p>对于这三部分内容，request 对象都提供了对应的API方法来获取，具体如下:</p><ul><li>获取请求方式：<code>GET</code></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>获取虚拟目录（项目访问路径）：<code>/request-demo</code></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">getContextPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>获取 URL（统一资源定位符）：<code>http://localhost:8080/request-demo/req1</code></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">StringBuffer</span> <span class="token function">getRequestURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>获取 URI（统一资源标识符）：<code>/request-demo/req1</code></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>获取请求参数（GET 方式）：<code>username=zhangsan&amp;password=123</code></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>介绍完上述方法后，咱们通过代码把上述方法都使用下:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * request 获取请求数据
 */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/req1&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo1</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// String getMethod()：获取请求方式： GET</span>
        <span class="token class-name">String</span> method <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//GET</span>
        <span class="token comment">// String getContextPath()：获取虚拟目录(项目访问路径)：/request-demo</span>
        <span class="token class-name">String</span> contextPath <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getContextPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>contextPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// StringBuffer getRequestURL(): 获取URL(统一资源定位符)：http://localhost:8080/request-demo/req1</span>
        <span class="token class-name">StringBuffer</span> url <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRequestURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// String getRequestURI()：获取URI(统一资源标识符)： /request-demo/req1</span>
        <span class="token class-name">String</span> uri <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// String getQueryString()：获取请求参数（GET方式）： username=zhangsan</span>
        <span class="token class-name">String</span> queryString <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>queryString<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动服务器，访问 <code>http://localhost:8080/request-demo/req1?username=zhangsan&amp;passwrod=123</code>，获取的结果如下:</p><p><img src="`+v+'" alt="1628762794935"></p><h4 id="获取请求头数据" tabindex="-1"><a class="header-anchor" href="#获取请求头数据" aria-hidden="true">#</a> 获取请求头数据</h4><p>对于请求头的数据，格式为 <code>key: value</code>，如下:</p><p><img src="'+m+`" alt="1628768652535"></p><p>所以根据请求头名称获取对应值的方法为:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>接下来，在代码中如果想要获取客户端浏览器的版本信息，则可以使用</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * request 获取请求数据
 */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/req1&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo1</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取请求头: user-agent: 浏览器的版本信息</span>
        <span class="token class-name">String</span> agent <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;user-agent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>agent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新启动服务器后，<code>http://localhost:8080/request-demo/req1?username=zhangsan&amp;passwrod=123</code>，获取的结果如下:</p><p><img src="`+g+'" alt="1628769145524"></p><h4 id="获取请求体数据" tabindex="-1"><a class="header-anchor" href="#获取请求体数据" aria-hidden="true">#</a> 获取请求体数据</h4><p><strong>注意</strong>：浏览器在发送GET请求的时候是没有请求体的，所以需要把请求方式变更为 POST，请求体中的数据格式如下:</p><p><img src="'+b+`" alt="1628768665185"></p><p>对于请求体中的数据，Request 对象提供了如下两种方式来获取其中的数据，分别是:</p><ul><li>获取字节输入流，如果前端发送的是字节数据，比如传递的是文件数据，则使用该方法：</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">ServletInputStream</span> <span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>获取字符输入流，如果前端发送的是纯文本数据，则使用该方法：</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">BufferedReader</span> <span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>注意</strong>：</p><p>BufferedReader 流是通过 request 对象来获取的，当请求完成后 request 对象就会被销毁，request 对象被销毁后，BufferedReader 流就会自动关闭，所以此处就不需要手动关闭流了。</p><h4 id="获取请求参数的通用方式" tabindex="-1"><a class="header-anchor" href="#获取请求参数的通用方式" aria-hidden="true">#</a> 获取请求参数的通用方式</h4><p>对于请求参数的获取，常用的有以下两种方式:</p><ul><li>GET 方式：</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>POST 方式：</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">BufferedReader</span> <span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>有了上述的知识储备，我们来实现一个案例需求：</p><ul><li>发送一个 GET 请求并携带用户名，后台接收后打印到控制台</li><li>发送一个 POST 请求并携带用户名，后台接收后打印到控制台</li></ul><p>此处需要注意的是 GET 请求和 POST 请求接收参数的方式不一样，具体实现的代码如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/req1&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo1</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对于上述的代码，会存在什么问题呢：</p><p><img src="`+q+'" alt="1628776252445"></p><p>如何解决上述重复代码的问题呢：</p><p><img src="'+S+`" alt="1628776433318"></p><p>当然，可以在 doGet() 中调用 doPost()，在 doPost() 中完成参数的获取和打印，另外需要注意的是，doGet() 和 doPost() 方法都必须存在，不能删除任意一个。</p><p>GET 请求方式和 POST 请求方式区别主要在于获取请求参数的方式不一样，是否可以提供一种 <strong>统一获取请求参数</strong> 的方式，从而 <strong>统一 doGet() 和 doPost() 方法内的代码</strong>？</p><p><strong>解决方案一</strong>：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/req1&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo1</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取请求方式</span>
        <span class="token class-name">String</span> method <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取请求参数</span>
        <span class="token class-name">String</span> params <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            params <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">BufferedReader</span> reader <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            params <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//将请求参数进行打印控制台</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 request 的 getMethod() 方法来获取请求方式，根据请求方式的不同来分别获取请求参数值，这样就可以解决上述问题，但是如果以后每个 Servlet 都需要这样写代码，那实现起来太麻烦了，所以这种方案我们一般不采用。</p><p><strong>解决方案二</strong>：</p><p>request 对象已经将上述获取请求参数的方法进行了封装，并且 request 提供的方法实现的功能更强大，以后只需要调用 request 提供的方法即可，在 request 的方法中都实现了哪些操作？</p><ol><li>根据不同的请求方式获取请求参数，获取的内容如下</li></ol><img src="`+h+'" alt="1628778931277" style="zoom:67%;"><ol start="2"><li>把获取到的内容进行分割，内容如下：</li></ol><img src="'+w+'" alt="1628779067793" style="zoom:67%;"><ol start="3"><li>把分割后的数据，存入到一个 Map 集合中：</li></ol><img src="'+y+`" alt="1628779368501" style="zoom:67%;"><p><strong>注意</strong>：因为参数的值可能是一个，也可能有多个，所以 Map 的值的类型为 String 数组。</p><p>基于上述理论，request 对象为我们提供了如下方法:</p><ul><li>获取所有参数Map集合</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Map</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token function">getParameterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>根据名称获取参数值（数组）</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getParameterValues</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>根据名称获取参数值（单个值）</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>总结：</p><ul><li><p><code>req.getParameter()</code> 方法使用的频率会比较高</p></li><li><p>以后我们再写代码的时候，就只需要按照如下格式来编写：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo1</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
       <span class="token comment">//采用request提供的获取请求参数的通用方式来获取请求参数</span>
       <span class="token comment">//编写其他的业务代码...</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="request-请求参数中文乱码问题" tabindex="-1"><a class="header-anchor" href="#request-请求参数中文乱码问题" aria-hidden="true">#</a> Request 请求参数中文乱码问题</h3><p>问题引入：</p><ol><li><p>将 req.html 页面的请求方式修改为 get：</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/request-demo/req2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   	 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
    		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hobby<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 游泳
    		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hobby<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 爬山 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
   	 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在 Servlet 中获取参数，并打印：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 中文乱码问题解决方案
 */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/req4&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo4</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
       <span class="token comment">//1. 获取username</span>
       <span class="token class-name">String</span> username <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>启动服务器，页面上输入中文参数：</p></li></ol><p><img src="`+R+'" alt="1628784323297"></p><ol start="4"><li>查看控制台打印内容</li></ol><p><img src="'+s+'" alt="1628784356157"></p><ol start="5"><li>把 req.html 页面的请求方式改成 post，再次发送请求和中文参数</li><li>查看控制台打印内容，依然为乱码</li></ol><p><img src="'+s+`" alt="1628784356157"></p><p>通过上面的案例不难发现，不管是 GET 还是 POST 请求，在发送的请求参数中如果有中文，在后台接收的时候，都会出现中文乱码的问题。下面来讲述该如何解决乱码问题：</p><h4 id="post-请求解决方案" tabindex="-1"><a class="header-anchor" href="#post-请求解决方案" aria-hidden="true">#</a> POST 请求解决方案</h4><ul><li><p>分析出现中文乱码的原因：</p><ul><li>POST 的请求参数是通过 reques t的 getReader() 来获取流中的数据</li><li>Tomcat 在获取流的时候采用的编码是 ISO-8859-1</li><li>而 ISO-8859-1 编码是不支持中文的，所以会出现乱码</li></ul></li><li><p>解决方案：</p><ul><li><p>页面设置的编码格式为 UTF-8</p></li><li><p>把 Tomcat 在获取流数据之前的编码设置为 UTF-8</p></li><li><p>通过 request.setCharacterEncoding(&quot;UTF-8&quot;) 设置编码，UTF-8 也可以写成小写</p></li></ul></li></ul><p>修改后的代码为:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 中文乱码问题解决方案
 */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/req4&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo4</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. 解决乱码: POST getReader()</span>
        <span class="token comment">//设置字符输入流的编码，设置的字符集要和页面保持一致</span>
        request<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2. 获取username</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新发送 POST 请求，就会在控制台看到正常展示的中文结果。</p><p>至此 POST 请求中文乱码的问题就已经解决，但是这种方案不适用于 GET 请求，这个原因是什么呢，咱们下面再分析。</p><h4 id="get-请求解决方案" tabindex="-1"><a class="header-anchor" href="#get-请求解决方案" aria-hidden="true">#</a> GET 请求解决方案</h4><p>刚才提到一个问题是 <strong>POST 请求的中文乱码解决方案为什么不适用 GET 请求</strong>？</p><ul><li>GET 请求获取请求参数的方式是 <code>request.getQueryString()</code></li><li>POST 请求获取请求参数的方式是 <code>request.getReader()</code></li><li>request.setCharacterEncoding(&quot;utf-8&quot;)是设置 request 处理流的编码</li><li><strong>getQueryString 方法并没有通过流的方式获取数据</strong></li></ul><p>所以 GET 请求不能用设置编码的方式来解决中文乱码问题，那问题又来了，如何解决 GET 请求的中文乱码呢？</p><p>首先我们需要先分析下 GET 请求出现乱码的原因：</p><img src="`+f+`" alt="1628829610823" style="zoom:67%;"><ol><li>浏览器通过 HTTP 协议发送请求和数据给后台服务器（Tomcat)</li><li>浏览器在发送 HTTP 的过程中会对中文数据进行<strong>URL编码</strong></li><li>在进行 <strong>URL编码</strong> 的时候会采用页面 <code>&lt;meta&gt;</code> 标签指定的 UTF-8 的方式进行编码，<code>张三 </code> 编码后的结果为 <code>%E5%BC%A0%E4%B8%89</code></li><li>后台服务器（Tomcat）接收到 <code>%E5%BC%A0%E4%B8%89</code> 后会默认按照 <code>ISO-8859-1</code> 进行<strong>URL解码</strong></li><li><strong>由于前后编码与解码采用的格式不一样</strong>，就会导致后台获取到的数据为乱码</li></ol><p>思考：如果把 <code>req.html</code> 页面的 <code>&lt;meta&gt;</code> 标签的 charset 属性改成<code>ISO-8859-1</code>,后台不做操作，能解决中文乱码问题么?</p><p>答案是否定的，因为<code>ISO-8859-1</code>本身是不支持中文展示的，所以改了 <code>&lt;meta&gt;</code> 标签的 charset 属性后，会导致页面上的中文内容都无法正常展示了。</p><p>分析完上面的问题后，我们会发现，其中有两个我们不熟悉的内容就是 **URL编码 **和 <strong>URL解码</strong>，什么是 <strong>URL编码</strong>，什么又是 <strong>URL解码</strong> 呢？</p><p>URL 具体的编码过程分两步，分别是：</p><ol><li>将字符串按照编码方式转为二进制</li><li>每个字节转为2个16进制数并在前边加上%</li></ol><p><code>张三 </code>按照 UTF-8 的方式转换成二进制的结果为:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>1110 0101 1011 1100 1010 0000 1110 0100 1011 1000 1000 1001
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在 Java 中已经为我们提供了编码和解码的 API 工具类可以让我们更快速的进行编码和解码:</p><p>编码：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URLEncoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">&quot;需要被编码的内容&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;字符集(UTF-8)&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>解码：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URLDecoder</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">&quot;需要被解码的内容&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;字符集(UTF-8)&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>接下来咱们对 <code>张三</code> 来进行编码和解码</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">URLDemo</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnsupportedEncodingException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//1. URL编码</span>
        <span class="token class-name">String</span> encode <span class="token operator">=</span> <span class="token class-name">URLEncoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>encode<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//打印:%E5%BC%A0%E4%B8%89</span>

       <span class="token comment">//2. URL解码</span>
       <span class="token comment">//String decode = URLDecoder.decode(encode, &quot;utf-8&quot;);//打印:张三</span>
       <span class="token class-name">String</span> decode <span class="token operator">=</span> <span class="token class-name">URLDecoder</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>encode<span class="token punctuation">,</span> <span class="token string">&quot;ISO-8859-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印:\`å¼ ä¸ \`</span>
       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>decode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在进行编码和解码的时候，不管使用的是哪个字符集，他们对应的二进制值是一样的。</p><p>所以我们可以考虑把 <code>å¼ ä¸</code> 转换成字节，再把字节转换成 <code>张三</code>，在转换的过程中保持它们的编码一致，就可以解决中文乱码问题。</p><p>具体的实现步骤为：</p><ol><li>按照 ISO-8859-1 编码获取乱码 <code>å¼ ä¸</code> 对应的字节数组</li><li>按照 UTF-8 编码获取字节数组对应的字符串</li></ol><p>实现代码如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">URLDemo</span> <span class="token punctuation">{</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnsupportedEncodingException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//1. URL编码</span>
        <span class="token class-name">String</span> encode <span class="token operator">=</span> <span class="token class-name">URLEncoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>encode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2. URL解码</span>
        <span class="token class-name">String</span> decode <span class="token operator">=</span> <span class="token class-name">URLDecoder</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>encode<span class="token punctuation">,</span> <span class="token string">&quot;ISO-8859-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>decode<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//此处打印的是对应的乱码数据</span>
        <span class="token comment">//3. 转换为字节数据,编码</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> decode<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;ISO-8859-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">byte</span> b <span class="token operator">:</span> bytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>b <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
		<span class="token comment">//此处打印的是:-27 -68 -96 -28 -72 -119</span>
        <span class="token comment">//4. 将字节数组转为字符串，解码</span>
        <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//此处打印的是张三</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>至此对于GET请求中文乱码的解决方案，我们就已经分析完了，最后在代码中去实现下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 中文乱码问题解决方案
 */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/req4&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo4</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. 解决乱码：POST，getReader()</span>
        <span class="token comment">//request.setCharacterEncoding(&quot;UTF-8&quot;);//设置字符输入流的编码</span>
      
        <span class="token comment">//2. 获取username</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;解决乱码前：&quot;</span><span class="token operator">+</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//3. GET,获取参数的方式：getQueryString</span>
        <span class="token comment">// 乱码原因：tomcat进行URL解码，默认的字符集ISO-8859-1</span>
        <span class="token comment">//3.1 先对乱码数据进行编码：转为字节数组</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> username<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">ISO_8859_1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.2 字节数组解码</span>
        username <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">/</span>
        username  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>username<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">ISO_8859_1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;解决乱码后：&quot;</span><span class="token operator">+</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>注意</strong>：</p><ul><li>把 <code>request.setCharacterEncoding(&quot;UTF-8&quot;)</code> 代码注释掉后，会发现 GET 请求参数乱码解决方案同时也可也把 POST 请求参数乱码的问题也解决了</li><li>只不过对于 POST 请求参数一般都会比较多，采用这种方式解决乱码起来比较麻烦，所以对于 POST 请求还是建议使用设置编码的方式进行。</li></ul><p>另外需要说明一点的是 <strong>Tomcat8.0 之后，已将 GET 请求乱码问题解决，设置默认的解码方式为 UTF-8</strong></p><h3 id="request-请求转发" tabindex="-1"><a class="header-anchor" href="#request-请求转发" aria-hidden="true">#</a> Request 请求转发</h3><p>请求转发（forward）是一种在服务器内部的资源跳转方式。</p><p><img src="`+x+`" alt=""></p><ol><li>浏览器发送请求给服务器，服务器中对应的资源A接收到请求</li><li>资源 A 处理完请求后将请求发给资源 B</li><li>资源 B 处理完后将结果响应给浏览器</li><li>请求从资源 A 到资源 B 的过程就叫 <strong>请求转发</strong>**</li></ol><p>请求转发的实现方式：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>req<span class="token punctuation">.</span><span class="token function">getRequestDispatcher</span><span class="token punctuation">(</span><span class="token string">&quot;资源B路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>请求转发时，资源间共享数据用的是 Request 对象，需要使用 request 对象提供的三个方法:</p><ul><li>存储数据到 request 域[范围， 数据是存储在request对象]中</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>根据 key 获取值</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Object</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>根据 key 删除该键值对</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>请求转发的特点：</p><ul><li><p>请求被转发时，浏览器地址栏的路径并不会发生任何变化，仍然是被转发前的路径</p></li><li><p>只能转发到当前服务器的内部资源，不能从一个服务器通过转发访问另一台服务器</p></li><li><p>一次请求，可以在转发资源间使用 request 共享数据</p></li></ul><h2 id="response-对象" tabindex="-1"><a class="header-anchor" href="#response-对象" aria-hidden="true">#</a> Response 对象</h2><p>前面讲解完 Request 对象，接下来我们回到刚开始的那张图:</p><img src="`+n+'" alt="1628735746602" style="zoom:50%;"><ul><li>Request：使用 request 对象来 <strong>获取请求数据</strong></li><li>Response：使用 response 对象来 <strong>设置响应数据</strong></li></ul><p>Reponse 的继承体系和 Request 的继承体系也非常相似：</p><img src="'+j+'" alt="1628857761317" style="zoom:80%;"><h3 id="response-设置响应数据功能介绍" tabindex="-1"><a class="header-anchor" href="#response-设置响应数据功能介绍" aria-hidden="true">#</a> Response 设置响应数据功能介绍</h3><p>HTTP 响应数据总共分为三部分内容，分别是 <strong>响应行、响应头、响应体</strong>。</p><ol><li>响应行</li></ol><p><img src="'+E+`" alt="1628858926498"></p><p>对于响应头，比较常用的就是设置响应状态码:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token keyword">int</span> sc<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>响应头</li></ol><p><img src="`+T+`" alt="1628859051368"></p><p>设置响应头键值对：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">String</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>响应体</li></ol><p><img src="`+H+`" alt="1628859268095"></p><p>对于响应体，是通过字符、字节输出流的方式往浏览器写，</p><p>获取字符输出流:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">PrintWriter</span> <span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>获取字节输出流</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">ServletOutputStream</span> <span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="respones-请求重定向" tabindex="-1"><a class="header-anchor" href="#respones-请求重定向" aria-hidden="true">#</a> Respones 请求重定向</h3><p>Response 重定向（redirect）是一种资源跳转方式。</p><img src="`+P+`" alt="1628859860279" style="zoom:67%;"><ol><li>浏览器发送请求给服务器，服务器中对应的资源A接收到请求</li><li>资源 A 现在无法处理该请求，就会给浏览器响应一个 302 的状态码+location 的一个访问资源 B 的路径</li><li>浏览器接收到响应状态码为 302 就会重新发送请求到 location 对应的访问地址去访问资源 B</li><li>资源 B 接收到请求后进行处理并最终给浏览器响应结果，这整个过程就叫 <strong>重定向</strong></li></ol><p>重定向的实现方式：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>resp<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">302</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;location&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;资源B的访问路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>从设置重定向的两行代码来看，会发现每次重定向时，除了重定向的地址不一样，其他部分的内容都是一模一样的，所以request对象给我们提供了简化的重定向代码：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>resposne<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span><span class="token string">&quot;/request-demo/resp2&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>重定向的特点：</p><ul><li><p>当进行重定向访问的时候，由于是由浏览器发送的两次请求，所以浏览器地址栏路径会发生变化</p></li><li><p>可以重定向到任何位置的资源（服务内容、外部均可）</p><p>因为第一次响应结果中包含了浏览器下次要跳转的路径，所以这个路径是可以任意位置资源</p></li><li><p>因为浏览器实际上发送了两次请求，是两个不同的 request 对象，所以就无法通过 request 对象进行共享数据</p></li></ul><p><strong>请求重定向</strong> 和 <strong>请求转发</strong> 的对比：</p><table><thead><tr><th>重定向的特点</th><th>请求转发的特点</th></tr></thead><tbody><tr><td>浏览器地址栏的路径发生变化</td><td>浏览器地址栏的路径不发生变化</td></tr><tr><td>可以重定向到任意位置的资源（服务器内部、外部均可)</td><td>只能转发到当前服务器的内部资源</td></tr><tr><td>两次请求，不能在多个资源使用 request 共享数据</td><td>—次请求，可以在转发的资源间使用 request 共享数据</td></tr></tbody></table><p>以后到底用哪个，还是需要根据具体的业务来决定。</p><h3 id="路径问题" tabindex="-1"><a class="header-anchor" href="#路径问题" aria-hidden="true">#</a> 路径问题</h3><ul><li><p>问题1：请求转发的时候，目标路径上没有加 <strong>项目根目录</strong>，而请求重定向的时候加了，那么到底什么时候需要加，什么时候不需要加呢？</p><p>其实判断的依据很简单，只需要明确路径是给谁使用的就行：</p><ul><li>浏览器使用：需要加虚拟目录（项目访问路径）</li><li>服务端使用：不需要加虚拟目录</li></ul><p>对于转发来说，因为是在服务端进行的，所以不需要加虚拟目录；对于重定向来说，路径最终是由浏览器来发送请求，就需要添加虚拟目录。</p></li><li><p>问题2：在重定向的代码中，路径里的 <strong>项目根目录</strong> 是固定编码的，如果后期通过 Tomcat 插件重新配置了项目的访问路径，那么所有需要重定向的地方都需要重新修改吗，该如何优化呢？</p><p>答案是我们可以在代码中动态去获取项目访问的虚拟目录，借助前面咱们所学习的 request 对象中的 getContextPath() 方法，修改后的代码如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/resp1&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResponseDemo1</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;resp1....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//简化方式完成重定向</span>
        <span class="token comment">//动态获取虚拟目录</span>
        <span class="token class-name">String</span> contextPath <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getContextPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span>contextPath<span class="token operator">+</span><span class="token string">&quot;/resp2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新启动访问测试，功能依然能够实现，此时就可以动态获取项目访问的虚拟路径，从而降低了代码的耦合度。</p></li></ul><h3 id="response-响应字符数据" tabindex="-1"><a class="header-anchor" href="#response-响应字符数据" aria-hidden="true">#</a> Response 响应字符数据</h3><p>要想将字符数据写回到浏览器，我们需要两个步骤:</p><ul><li><p>通过 Response 对象获取字符输出流： PrintWriter writer = resp.getWriter();</p></li><li><p>通过字符输出流写数据：writer.write(&quot;aaa&quot;);</p></li></ul><p>注意：一次请求响应结束后，response 对象就会被销毁掉，所以不用手动关闭流。</p><h3 id="response-响应字节数据" tabindex="-1"><a class="header-anchor" href="#response-响应字节数据" aria-hidden="true">#</a> Response 响应字节数据</h3><p>要想将字节数据写回到浏览器，我们需要两个步骤:</p><ul><li><p>通过 Respons e对象获取字节输出流：ServletOutputStream outputStream = resp.getOutputStream();</p></li><li><p>通过字节输出流写数据: outputStream.write(字节数据);</p></li></ul><p>接下来，我们实现通用字节流返回一个图片文件到浏览器：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 响应字节数据：设置字节数据的响应体
 */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/resp4&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResponseDemo4</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. 读取文件</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;d://a.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2. 获取response字节输出流</span>
        <span class="token class-name">ServletOutputStream</span> os <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3. 完成流的copy</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buff<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buff<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上述代码中，对于流的 copy 的代码还是比较复杂的，所以我们可以使用别人提供好的方法来简化代码的开发，具体的步骤是:</p><ol><li><p>pom.xml添加依赖</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>commons-io<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-io<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>调用工具类方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//fis:输入流</span>
<span class="token comment">//os:输出流</span>
<span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>fis<span class="token punctuation">,</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>优化后的代码:</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * 响应字节数据：设置字节数据的响应体
 */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/resp4&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResponseDemo4</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. 读取文件</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">&quot;d://a.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2. 获取response字节输出流</span>
        <span class="token class-name">ServletOutputStream</span> os <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3. 完成流的copy</span>
      	<span class="token class-name">IOUtils</span><span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>fis<span class="token punctuation">,</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span>
        fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol>`,220);function I(G,U){return t(),e("div",null,[p(" more "),A])}const L=a(O,[["render",I],["__file","RequestheResponse.html.vue"]]);export{L as default};
